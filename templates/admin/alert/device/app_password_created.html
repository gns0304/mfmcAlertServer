{% extends "admin/base_site.html" %}
{% block content %}
  <h1>앱 비밀번호 생성 완료</h1>

  <p>
    <strong>장비:</strong> {{ device }}<br>
    <strong>계정:</strong> {{ username }}
  </p>

  <div style="margin: 16px 0; padding: 12px; border: 1px solid #ddd; border-radius: 8px;">
    <p style="margin:0 0 8px 0;">
      아래 비밀번호는 <strong>이 화면에서만</strong> 확인할 수 있습니다. 복사해서 장비 설정에 저장하세요.
    </p>

    <div style="display:flex; gap:8px; align-items:center;">
      <input id="pw" type="text" value="{{ app_password }}" readonly
             style="width:420px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', monospace; padding:8px;">
      <button type="button" class="button" onclick="copyPw()">복사</button>
    </div>
  </div>

  <script>
    function copyPw() {
      const el = document.getElementById("pw");
      el.select();
      el.setSelectionRange(0, 99999);
      navigator.clipboard.writeText(el.value).then(() => {
        alert("복사 완료");
      }).catch(() => {
        // clipboard API 실패 대비(구형 브라우저)
        document.execCommand("copy");
        alert("복사 완료");
      });
    }
  </script>

  <div class="submit-row">
    <a class="button" href="{% url 'admin:alert_device_changelist' %}">장비 목록으로</a>
    <a class="button default" href="{% url 'admin:alert_device_change' device.id %}">이 장비로</a>
  </div>
{% endblock %}